const bel = require('bel')
const file = require('path').basename(__filename)

module.exports = planPlay

function planPlay ({name = null, flow = 'layout', page}, protocol) {
    const sender = protocol (get)
    sender({page, from: `plan-play/${name}`, flow, type: 'ready', fn: 'planPlay', file, line: 9 })
    const cancelButton = bel`<button class="btn" data-action="cancel" aria-label="Cancel" onclick="${() => handleCancel()}">Cancel</button>`
    const confirmButton = bel`<button class="btn" data-action="confirm" aria-label="Confirm" onclick="${() => handleConfirm()}">Confirm</button>`
    const el = bel`
    <section class="row" data-action="plan-play" aria-label="Plan play"> 
        <p>
            Do you determine to be a sponsor for <strong>${name}</strong>?<br/>
            This action will be continuous paying via your schedule.
        </p>
        <div class="actions" role="action">
            ${cancelButton}${confirmButton}
        </div>
    </section>`

    return el

    function handleCancel () {
        sender({from: `${name}/cancel`, flow: 'plan-play/button', type: 'click', fn: 'handleCancel', file, line: 25})
    }

    function handleConfirm () {
        sender({from: `${name}/confirm`, flow: 'plan-play/button', type: 'click', fn: 'handleConfirm', file, line: 29})
    }

    function get (msg) {
        console.log( msg );
    }
}