const myElementSheet = new CSSStyleSheet();
class MyElement extends HTMLElement {
  constructor() {
    super();
    const shadowRoot = this.attachShadow({ mode: "closed" });
    shadowRoot.adoptedStyleSheets = [myElementSheet];
    shadowRoot.innerHTML = `
    ${this.getAttribute('text')} 
    <slot class="custom" name="custom" />
    `
  }
  
  connectedCallback() {
    // Only actually parse the stylesheet when the first instance is connected.
    if (myElementSheet.cssRules.length == 0) {
       myElementSheet.replaceSync(`
       :host(my-element) {
           display: block;
           background-color: red;
       }
       `);
    }
  }
}

customElements.define('my-element', MyElement)